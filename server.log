2023-10-06 13:31:33.926  INFO 37024 --- [main] m.e.service.impl.ExcelServiceImplTest    : Starting ExcelServiceImplTest using Java 16.0.2 on mao with PID 37024 (started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 13:31:33.929 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImplTest    : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 13:31:33.929  INFO 37024 --- [main] m.e.service.impl.ExcelServiceImplTest    : No active profile set, falling back to 1 default profile: "default"
2023-10-06 13:31:34.191  INFO 37024 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 13:31:34.396  INFO 37024 --- [main] m.e.service.impl.ExcelServiceImplTest    : Started ExcelServiceImplTest in 0.686 seconds (JVM running for 1.321)
2023-10-06 13:31:34.611 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 13:31:34.612 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 13:31:34.905 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 13:31:34.906 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 13:31:34.909 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 13:31:34.913 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 13:31:34.914 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 13:31:34.914 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 13:31:34.914 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 13:31:34.914 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 13:31:34.914 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 13:31:34.915 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 13:31:34.915 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 13:31:34.915 DEBUG 37024 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 13:40:04.287  INFO 36000 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 36000 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 13:40:04.288 DEBUG 36000 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 13:40:04.288  INFO 36000 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 13:40:04.501  INFO 36000 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 13:40:04.573  INFO 36000 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.453 seconds (JVM running for 0.69)
2023-10-06 13:40:04.575  INFO 36000 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 13:40:04.576  INFO 36000 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 13:40:04.576  INFO 36000 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 13:40:04.576  INFO 36000 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 13:40:04.576  INFO 36000 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 13:40:04.576  INFO 36000 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 13:40:04.576  INFO 36000 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 13:40:04.576  INFO 36000 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 13:40:04.576 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 13:40:04.576 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 13:40:04.774 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 13:40:04.774 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 13:40:04.777 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 13:40:04.780 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 13:40:04.781 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 13:40:04.781 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 13:40:04.781 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 13:40:04.781 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 13:40:04.781 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 13:40:04.782 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 13:40:04.782 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 13:40:04.782 DEBUG 36000 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 13:40:04.782 DEBUG 36000 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 13:40:04.782  INFO 36000 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 13:57:15.900  INFO 10572 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 10572 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 13:57:15.901 DEBUG 10572 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 13:57:15.901  INFO 10572 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 13:57:16.141  INFO 10572 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 13:57:16.183  WARN 10572 --- [main] s.c.a.AnnotationConfigApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'runServiceImpl': Unsatisfied dependency expressed through field 'sqlDataHandlerList'; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'java.util.List<mao.excel_to_sql_test.handler.SqlDataHandler>' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
2023-10-06 13:57:16.187  INFO 10572 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2023-10-06 13:57:16.197 ERROR 10572 --- [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Field sqlDataHandlerList in mao.excel_to_sql_test.service.impl.RunServiceImpl required a bean of type 'java.util.List' that could not be found.

The injection point has the following annotations:
	- @org.springframework.beans.factory.annotation.Autowired(required=true)


Action:

Consider defining a bean of type 'java.util.List' in your configuration.

2023-10-06 13:58:45.192  INFO 30740 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 30740 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 13:58:45.193 DEBUG 30740 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 13:58:45.193  INFO 30740 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 13:58:45.400  INFO 30740 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 13:58:45.470  INFO 30740 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.427 seconds (JVM running for 0.657)
2023-10-06 13:58:45.471  INFO 30740 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 13:58:45.472  INFO 30740 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 13:58:45.472  INFO 30740 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 13:58:45.472  INFO 30740 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 13:58:45.472  INFO 30740 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 13:58:45.472  INFO 30740 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 13:58:45.472  INFO 30740 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 13:58:45.472  INFO 30740 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 13:58:45.472 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 13:58:45.472 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 13:58:45.647 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 13:58:45.647 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 13:58:45.649 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 13:58:45.651 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 13:58:45.652 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 13:58:45.652 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 13:58:45.652 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 13:58:45.652 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 13:58:45.652 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 13:58:45.653 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 13:58:45.653 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 13:58:45.653 DEBUG 30740 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 13:58:45.653 DEBUG 30740 --- [main] m.e.service.impl.RunServiceImpl          : 执行顺序：-->字段去重excel数据处理器-->字段排序excel数据处理器
2023-10-06 13:58:45.653 DEBUG 30740 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 13:58:45.654  INFO 30740 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:02:29.145  INFO 12564 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 12564 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:02:29.146 DEBUG 12564 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:02:29.146  INFO 12564 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:02:29.333  INFO 12564 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:02:29.407  INFO 12564 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.429 seconds (JVM running for 0.658)
2023-10-06 14:02:29.409  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:02:29.410  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:02:29.410  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:02:29.410  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:02:29.410  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:02:29.410  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:02:29.410  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:02:29.410  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:02:29.410 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:02:29.410 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:02:29.605 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:02:29.605 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:02:29.606 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:02:29.609 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:02:29.609 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:02:29.610 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:02:29.610 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:02:29.610 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:02:29.610 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:02:29.610 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:02:29.610 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:02:29.610 DEBUG 12564 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:02:29.611  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : excel数据处理器执行顺序：-->字段去重excel数据处理器-->字段排序excel数据处理器
2023-10-06 14:02:29.611 DEBUG 12564 --- [main] m.e.service.impl.RunServiceImpl          : 开始进入 字段去重excel数据处理器
2023-10-06 14:02:29.611 DEBUG 12564 --- [main] m.e.service.impl.RunServiceImpl          : 退出 字段去重excel数据处理器
2023-10-06 14:02:29.611 DEBUG 12564 --- [main] m.e.service.impl.RunServiceImpl          : 开始进入 字段排序excel数据处理器
2023-10-06 14:02:29.611 DEBUG 12564 --- [main] m.e.service.impl.RunServiceImpl          : 退出 字段排序excel数据处理器
2023-10-06 14:02:29.611 DEBUG 12564 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:02:29.611  INFO 12564 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:04:02.698  INFO 31692 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 31692 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:04:02.699 DEBUG 31692 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:04:02.699  INFO 31692 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:04:02.899  INFO 31692 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:04:02.991  INFO 31692 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.47 seconds (JVM running for 0.699)
2023-10-06 14:04:02.993  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:04:02.993  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:04:02.993  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:04:02.993  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:04:02.993  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:04:02.993  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:04:02.994  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:04:02.994  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:04:02.994 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:04:02.994 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:04:03.168 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:04:03.170 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:04:03.171 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:04:03.174 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:04:03.174 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:04:03.174 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:04:03.175 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:04:03.175 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:04:03.175 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:04:03.175 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:04:03.175 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:04:03.175 DEBUG 31692 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:04:03.176  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : excel数据处理器执行顺序：-->字段排序excel数据处理器-->字段去重excel数据处理器
2023-10-06 14:04:03.176 DEBUG 31692 --- [main] m.e.service.impl.RunServiceImpl          : 开始进入 字段排序excel数据处理器
2023-10-06 14:04:03.176 DEBUG 31692 --- [main] m.e.service.impl.RunServiceImpl          : 退出 字段排序excel数据处理器
2023-10-06 14:04:03.176 DEBUG 31692 --- [main] m.e.service.impl.RunServiceImpl          : 开始进入 字段去重excel数据处理器
2023-10-06 14:04:03.176 DEBUG 31692 --- [main] m.e.service.impl.RunServiceImpl          : 退出 字段去重excel数据处理器
2023-10-06 14:04:03.176 DEBUG 31692 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:04:03.176  INFO 31692 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:04:15.273  INFO 38780 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 38780 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:04:15.274 DEBUG 38780 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:04:15.274  INFO 38780 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:04:15.511  INFO 38780 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:04:15.602  INFO 38780 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.5 seconds (JVM running for 0.732)
2023-10-06 14:04:15.604  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:04:15.604  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:04:15.604  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:04:15.604  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:04:15.604  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:04:15.604  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:04:15.604  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:04:15.604  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:04:15.604 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:04:15.604 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:04:15.796 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:04:15.796 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:04:15.798 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:04:15.800 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:04:15.800 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:04:15.801 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:04:15.801 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:04:15.801 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:04:15.801 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:04:15.801 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:04:15.802 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:04:15.802 DEBUG 38780 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:04:15.802  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : excel数据处理器执行顺序：-->字段去重excel数据处理器-->字段排序excel数据处理器
2023-10-06 14:04:15.802 DEBUG 38780 --- [main] m.e.service.impl.RunServiceImpl          : 开始进入 字段去重excel数据处理器
2023-10-06 14:04:15.802 DEBUG 38780 --- [main] m.e.service.impl.RunServiceImpl          : 退出 字段去重excel数据处理器
2023-10-06 14:04:15.802 DEBUG 38780 --- [main] m.e.service.impl.RunServiceImpl          : 开始进入 字段排序excel数据处理器
2023-10-06 14:04:15.802 DEBUG 38780 --- [main] m.e.service.impl.RunServiceImpl          : 退出 字段排序excel数据处理器
2023-10-06 14:04:15.802 DEBUG 38780 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:04:15.802  INFO 38780 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:12:57.082  INFO 18524 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 18524 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:12:57.085 DEBUG 18524 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:12:57.086  INFO 18524 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:12:57.306  INFO 18524 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:12:57.392  INFO 18524 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.475 seconds (JVM running for 0.705)
2023-10-06 14:12:57.393  INFO 18524 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:12:57.393  INFO 18524 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:12:57.394  INFO 18524 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:12:57.394  INFO 18524 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:12:57.394  INFO 18524 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:12:57.394  INFO 18524 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:12:57.394  INFO 18524 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:12:57.394  INFO 18524 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:12:57.394 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:12:57.394 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:12:57.579 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:12:57.580 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:12:57.581 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:12:57.584 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:12:57.584 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:12:57.585 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:12:57.585 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:12:57.585 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:12:57.585 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:12:57.585 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:12:57.586 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:12:57.586 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:12:57.586  INFO 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : excel数据处理器执行顺序：-->字段去重excel数据处理器-->字段排序excel数据处理器
2023-10-06 14:12:57.586 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段去重excel数据处理器
2023-10-06 14:12:57.586 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段去重excel数据处理器
2023-10-06 14:12:57.586 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段排序excel数据处理器
2023-10-06 14:12:57.586 DEBUG 18524 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段排序excel数据处理器
2023-10-06 14:12:57.586 DEBUG 18524 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:12:57.586  INFO 18524 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:13:42.640  INFO 15088 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 15088 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:13:42.641 DEBUG 15088 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:13:42.642  INFO 15088 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:13:42.842  INFO 15088 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:13:42.920  INFO 15088 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.446 seconds (JVM running for 0.68)
2023-10-06 14:13:42.922  INFO 15088 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:13:42.923  INFO 15088 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:13:42.923  INFO 15088 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:13:42.923  INFO 15088 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:13:42.923  INFO 15088 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:13:42.923  INFO 15088 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:13:42.923  INFO 15088 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:13:42.923  INFO 15088 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:13:42.923 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:13:42.923 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:13:43.110 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:13:43.110 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:13:43.112 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:13:43.114 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:13:43.115 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:13:43.115 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:13:43.115 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:13:43.115 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:13:43.115 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:13:43.115 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:13:43.116 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:13:43.116 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:13:43.116  INFO 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : excel数据处理器执行顺序：-->字段去重excel数据处理器-->字段排序excel数据处理器
2023-10-06 14:13:43.116 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段去重excel数据处理器
2023-10-06 14:13:43.116  INFO 15088 --- [main] m.e.handler.DistinctExcelDataHandler     : 111
2023-10-06 14:13:43.116 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段去重excel数据处理器
2023-10-06 14:13:43.116 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段排序excel数据处理器
2023-10-06 14:13:43.116 DEBUG 15088 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段排序excel数据处理器
2023-10-06 14:13:43.116 DEBUG 15088 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:13:43.116  INFO 15088 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:24:10.704  INFO 20660 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 20660 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:24:10.706 DEBUG 20660 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:24:10.706  INFO 20660 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:24:10.907  INFO 20660 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:24:10.912  WARN 20660 --- [main] s.c.a.AnnotationConfigApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'saveExcelDataHandler': Unsatisfied dependency expressed through field 'excelService'; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'excelServiceImpl': Unsatisfied dependency expressed through field 'excelDataHandlerList'; nested exception is org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name 'saveExcelDataHandler': Requested bean is currently in creation: Is there an unresolvable circular reference?
2023-10-06 14:24:10.916  INFO 20660 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2023-10-06 14:24:10.922 ERROR 20660 --- [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

The dependencies of some of the beans in the application context form a cycle:

┌─────┐
|  saveExcelDataHandler (field private mao.excel_to_sql_test.service.ExcelService mao.excel_to_sql_test.handler.SaveExcelDataHandler.excelService)
↑     ↓
|  excelServiceImpl (field private java.util.List mao.excel_to_sql_test.service.impl.ExcelServiceImpl.excelDataHandlerList)
└─────┘


Action:

Relying upon circular references is discouraged and they are prohibited by default. Update your application to remove the dependency cycle between beans. As a last resort, it may be possible to break the cycle automatically by setting spring.main.allow-circular-references to true.

2023-10-06 14:24:36.162  INFO 26468 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 26468 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:24:36.163 DEBUG 26468 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:24:36.164  INFO 26468 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:24:36.350  INFO 26468 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:24:36.433  INFO 26468 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.432 seconds (JVM running for 0.662)
2023-10-06 14:24:36.435  INFO 26468 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:24:36.435  INFO 26468 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:24:36.436  INFO 26468 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:24:36.436  INFO 26468 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:24:36.436  INFO 26468 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:24:36.436  INFO 26468 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:24:36.436  INFO 26468 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:24:36.436  INFO 26468 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:24:36.436 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:24:36.436 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:24:36.657 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:24:36.657 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:24:36.659 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:24:36.662 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:24:36.663 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:24:36.663 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:24:36.663 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:24:36.664 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:24:36.664 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:24:36.664 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:24:36.664 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:24:36.665 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:24:36.665  INFO 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : excel数据处理器执行顺序：-->字段去重excel数据处理器-->字段排序excel数据处理器-->数据打印excel数据处理器-->保存excel数据处理器
2023-10-06 14:24:36.665 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段去重excel数据处理器
2023-10-06 14:24:36.665 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段去重excel数据处理器
2023-10-06 14:24:36.665 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段排序excel数据处理器
2023-10-06 14:24:36.666 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段排序excel数据处理器
2023-10-06 14:24:36.666 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 数据打印excel数据处理器
2023-10-06 14:24:36.666 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 数据打印excel数据处理器
2023-10-06 14:24:36.666 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 保存excel数据处理器
2023-10-06 14:24:36.732 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 保存的文件位于：out.xlsx
2023-10-06 14:24:36.732 DEBUG 26468 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 保存excel数据处理器
2023-10-06 14:24:36.732 DEBUG 26468 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:24:36.732  INFO 26468 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:33:36.089  INFO 11824 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 11824 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:33:36.090 DEBUG 11824 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:33:36.090  INFO 11824 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:33:36.279  INFO 11824 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:33:36.355  INFO 11824 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.444 seconds (JVM running for 0.685)
2023-10-06 14:33:36.356  INFO 11824 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:33:36.357  INFO 11824 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:33:36.357  INFO 11824 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:33:36.357  INFO 11824 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:33:36.357  INFO 11824 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:33:36.357  INFO 11824 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:33:36.357  INFO 11824 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:33:36.357  INFO 11824 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:33:36.357 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:33:36.357 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:33:36.573 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:33:36.573 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:33:36.575 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:33:36.577 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:33:36.577 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:33:36.577 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:33:36.577 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:33:36.578 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:33:36.578 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:33:36.578 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:33:36.578 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:33:36.578 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:33:36.665  INFO 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : excel数据处理器执行顺序：-->字段去重excel数据处理器-->字段排序excel数据处理器-->数据打印excel数据处理器-->保存excel数据处理器
2023-10-06 14:33:36.666 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段去重excel数据处理器
2023-10-06 14:33:36.666 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段去重excel数据处理器
2023-10-06 14:33:36.666 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段排序excel数据处理器
2023-10-06 14:33:36.666 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段排序excel数据处理器
2023-10-06 14:33:36.666 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 数据打印excel数据处理器
2023-10-06 14:33:36.666 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 数据打印excel数据处理器
2023-10-06 14:33:36.666 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 保存excel数据处理器
2023-10-06 14:33:36.763 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 保存的文件位于：out.xlsx
2023-10-06 14:33:36.763 DEBUG 11824 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 保存excel数据处理器
2023-10-06 14:33:36.763 DEBUG 11824 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:33:36.763  INFO 11824 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:33:50.444  INFO 31840 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 31840 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:33:50.445 DEBUG 31840 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:33:50.445  INFO 31840 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:33:50.644  INFO 31840 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:33:50.650  WARN 31840 --- [main] s.c.a.AnnotationConfigApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'distinctExcelDataHandler': Injection of autowired dependencies failed; nested exception is java.lang.IllegalArgumentException: Could not resolve placeholder 'ets.handler.enable' in value "${ets.handler.enable}"
2023-10-06 14:33:50.655  INFO 31840 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2023-10-06 14:33:50.665 ERROR 31840 --- [main] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'distinctExcelDataHandler': Injection of autowired dependencies failed; nested exception is java.lang.IllegalArgumentException: Could not resolve placeholder 'ets.handler.enable' in value "${ets.handler.enable}"
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:405) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918) ~[spring-context-5.3.21.jar:5.3.21]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583) ~[spring-context-5.3.21.jar:5.3.21]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:734) ~[spring-boot-2.7.1.jar:2.7.1]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408) ~[spring-boot-2.7.1.jar:2.7.1]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:308) ~[spring-boot-2.7.1.jar:2.7.1]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1306) ~[spring-boot-2.7.1.jar:2.7.1]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1295) ~[spring-boot-2.7.1.jar:2.7.1]
	at mao.excel_to_sql_test.ExcelToSqltestApplication.main(ExcelToSqltestApplication.java:14) ~[classes/:na]
Caused by: java.lang.IllegalArgumentException: Could not resolve placeholder 'ets.handler.enable' in value "${ets.handler.enable}"
	at org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:180) ~[spring-core-5.3.21.jar:5.3.21]
	at org.springframework.util.PropertyPlaceholderHelper.replacePlaceholders(PropertyPlaceholderHelper.java:126) ~[spring-core-5.3.21.jar:5.3.21]
	at org.springframework.core.env.AbstractPropertyResolver.doResolvePlaceholders(AbstractPropertyResolver.java:239) ~[spring-core-5.3.21.jar:5.3.21]
	at org.springframework.core.env.AbstractPropertyResolver.resolveRequiredPlaceholders(AbstractPropertyResolver.java:210) ~[spring-core-5.3.21.jar:5.3.21]
	at org.springframework.context.support.PropertySourcesPlaceholderConfigurer.lambda$processProperties$0(PropertySourcesPlaceholderConfigurer.java:191) ~[spring-context-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.AbstractBeanFactory.resolveEmbeddedValue(AbstractBeanFactory.java:936) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1332) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.resolveFieldValue(AutowiredAnnotationBeanPostProcessor.java:656) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:639) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119) ~[spring-beans-5.3.21.jar:5.3.21]
	at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:399) ~[spring-beans-5.3.21.jar:5.3.21]
	... 16 common frames omitted

2023-10-06 14:36:16.899  INFO 29400 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 29400 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:36:16.900 DEBUG 29400 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:36:16.901  INFO 29400 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:36:17.076  INFO 29400 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:36:17.140  INFO 29400 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.398 seconds (JVM running for 0.632)
2023-10-06 14:36:17.142  INFO 29400 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:36:17.142  INFO 29400 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:36:17.142  INFO 29400 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:36:17.142  INFO 29400 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:36:17.142  INFO 29400 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:36:17.142  INFO 29400 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:36:17.143  INFO 29400 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:36:17.143  INFO 29400 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:36:17.143 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:36:17.143 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:36:17.303 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:36:17.303 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:36:17.304 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:36:17.306 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:36:17.307 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:36:17.307 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:36:17.307 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:36:17.307 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:36:17.307 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:36:17.307 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:36:17.308 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:36:17.308 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:36:17.308  INFO 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : excel数据处理器执行顺序：-->字段去重excel数据处理器-->字段排序excel数据处理器-->数据打印excel数据处理器-->保存excel数据处理器
2023-10-06 14:36:17.308 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段去重excel数据处理器
2023-10-06 14:36:17.308 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段去重excel数据处理器
2023-10-06 14:36:17.308 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段排序excel数据处理器
2023-10-06 14:36:17.308 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段排序excel数据处理器
2023-10-06 14:36:17.308 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 数据打印excel数据处理器
2023-10-06 14:36:17.308 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 数据打印excel数据处理器
2023-10-06 14:36:17.308 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 保存excel数据处理器
2023-10-06 14:36:17.362 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 保存的文件位于：out.xlsx
2023-10-06 14:36:17.362 DEBUG 29400 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 保存excel数据处理器
2023-10-06 14:36:17.362 DEBUG 29400 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:36:17.363  INFO 29400 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:38:56.406  INFO 37352 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 37352 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:38:56.407 DEBUG 37352 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:38:56.408  INFO 37352 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:38:56.608  INFO 37352 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:38:56.688  INFO 37352 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.451 seconds (JVM running for 0.682)
2023-10-06 14:38:56.689  INFO 37352 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:38:56.690  INFO 37352 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:38:56.690  INFO 37352 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:38:56.690  INFO 37352 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:38:56.690  INFO 37352 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:38:56.690  INFO 37352 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:38:56.690  INFO 37352 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:38:56.690  INFO 37352 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:38:56.690 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:38:56.690 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:38:56.868 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:38:56.868 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:38:56.870 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:38:56.873 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:38:56.873 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:38:56.873 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:38:56.873 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:38:56.873 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:38:56.874 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:38:56.874 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:38:56.874 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:38:56.874 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:38:56.874  INFO 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : excel数据处理器执行顺序：-->字段去重excel数据处理器-->字段排序excel数据处理器-->数据打印excel数据处理器-->保存excel数据处理器
2023-10-06 14:38:56.874 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段去重excel数据处理器
2023-10-06 14:38:56.874 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段去重excel数据处理器
2023-10-06 14:38:56.874 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段排序excel数据处理器
2023-10-06 14:38:56.874 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段排序excel数据处理器
2023-10-06 14:38:56.874 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 数据打印excel数据处理器
2023-10-06 14:38:56.875 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 数据打印excel数据处理器
2023-10-06 14:38:56.875 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 保存excel数据处理器
2023-10-06 14:38:56.934 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 保存的文件位于：out.xlsx
2023-10-06 14:38:56.934 DEBUG 37352 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 保存excel数据处理器
2023-10-06 14:38:56.934 DEBUG 37352 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:38:56.934  INFO 37352 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:39:19.883  INFO 23532 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 23532 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:39:19.884 DEBUG 23532 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:39:19.885  INFO 23532 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:39:20.056  INFO 23532 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:39:20.122  INFO 23532 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.401 seconds (JVM running for 0.624)
2023-10-06 14:39:20.123  INFO 23532 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:39:20.123  INFO 23532 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:39:20.123  INFO 23532 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:39:20.123  INFO 23532 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:39:20.124  INFO 23532 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:39:20.124  INFO 23532 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:39:20.124  INFO 23532 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:39:20.124  INFO 23532 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:39:20.124 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:39:20.124 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:39:20.294 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:39:20.294 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:39:20.296 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:39:20.298 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:39:20.299 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:39:20.299 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:39:20.299 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:39:20.299 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:39:20.299 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:39:20.299 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:39:20.300 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:39:20.300 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:39:20.300  INFO 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : excel数据处理器执行顺序：-->字段排序excel数据处理器-->字段去重excel数据处理器-->数据打印excel数据处理器-->保存excel数据处理器
2023-10-06 14:39:20.300 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段排序excel数据处理器
2023-10-06 14:39:20.300 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段排序excel数据处理器
2023-10-06 14:39:20.300 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段去重excel数据处理器
2023-10-06 14:39:20.300 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段去重excel数据处理器
2023-10-06 14:39:20.300 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 数据打印excel数据处理器
2023-10-06 14:39:20.300 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 数据打印excel数据处理器
2023-10-06 14:39:20.300 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 保存excel数据处理器
2023-10-06 14:39:20.352 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 保存的文件位于：out.xlsx
2023-10-06 14:39:20.352 DEBUG 23532 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 保存excel数据处理器
2023-10-06 14:39:20.352 DEBUG 23532 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:39:20.353  INFO 23532 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:39:36.795  INFO 20804 --- [main] m.e.ExcelToSqltestApplication            : Starting ExcelToSqltestApplication using Java 16.0.2 on mao with PID 20804 (D:\程序\2023Q3\excel-to-sqltest\target\classes started by mao in D:\程序\2023Q3\excel-to-sqltest)
2023-10-06 14:39:36.796 DEBUG 20804 --- [main] m.e.ExcelToSqltestApplication            : Running with Spring Boot v2.7.1, Spring v5.3.21
2023-10-06 14:39:36.797  INFO 20804 --- [main] m.e.ExcelToSqltestApplication            : No active profile set, falling back to 1 default profile: "default"
2023-10-06 14:39:36.966  INFO 20804 --- [main] m.e.config.DataSourceConfig              : 初始化 DataSourceConfig
2023-10-06 14:39:37.029  INFO 20804 --- [main] m.e.ExcelToSqltestApplication            : Started ExcelToSqltestApplication in 0.387 seconds (JVM running for 0.62)
2023-10-06 14:39:37.031  INFO 20804 --- [main] m.e.service.impl.RunServiceImpl          : 


本程序用于将Excel文件里的数据转换成sql脚本，并选择执行!
通过自定义模板来生成想要的sql语句
1. 模板使用freemacker模板引擎实现，变量使用'${表头列名称}'格式来替换
2. freemacker支持加减乘除运算、条件语句、类型转换等，使用方法自行百度
3. 如果表头包含空格，写法'${.vars['CPU Temp']'
4. 数值类型会有逗号，可以使用类型转换，示例：'${(_index?number*2+100000)?c}'
5. 程序包含内置参数'_index'，可以直接使用，从0开始
6. excel的日期类型统一转换成时间戳，想要格式化的时间，可以写成'${Time?number?number_to_datetime?string('yyyy-MM-dd HH:mm:ss')}'
7. 对于excel中性别字段为男或女，但是数据库为0或1的，可以使用if else解决，示例：'insert into student values(${年龄},<#if 性别=='男'>0</#if><#if 性别=='女'>1</#if>)'
8. 数据库配置位于 druid.properties 文件里
9. 如果直接想要使用默认的模板，可以直接按回车即可，使用默认模板时，excel里的表头列名称要满足数据库规范
10.程序通过配置属性类读取配置，配置文件示例如下，可以通过修改application.yml来修改配置，也可以通过参数传递来让配置临时生效

ets:
  inputPath: './in.xlsx'    # excel文件的路径
  outputPath: './out.sql'    # sql文件的输出路径
  isWriteToMysql: false      # 是否直接执行输出的sql文件
  wrapNum: 1                 # sql文件两条sql之间换行的数量，也就是\n的个数
  distinct: ''               # 要去重的字段
  orderBy: ''                # 要排序的列，列为表头名称，升序为asc，降序为desc，按姓名降序：'姓名,desc'，按成绩升序：'成绩,asc'
  excel:
    sheetAt: 0               # 读取sheet的索引，从0开始，第一个sheet就是0，第二个sheet就是1
    startRow: 0              # 开始行，选择要从第几行开始读，从0开始，开始行必须为表头，从第4行开始就是3
    endRow: -1               # 结束行，值为-1默认读到最后一行
    startCell: 0             # 开始列，默认从第一列开始读
    endCell: -1              # 结束列，值为-1默认读到最后一列
  filter:                    # 过滤器，过滤掉满足以下条件的行，比如过滤掉‘所属班级’这一列中值为100001的行、过滤‘编码’字段值为‘Noinfo’、‘NotOnly’或者‘N000004-446-1151’的行
    "[编码]": ['Noinfo','NotOnly','N000004-446-1151']
    "[所属班级]": ['100001']



2023-10-06 14:39:37.031  INFO 20804 --- [main] m.e.service.impl.RunServiceImpl          : excel文件位置：./in6.xlsx
2023-10-06 14:39:37.031  INFO 20804 --- [main] m.e.service.impl.RunServiceImpl          : sql文件输出位置：./out.sql
2023-10-06 14:39:37.031  INFO 20804 --- [main] m.e.service.impl.RunServiceImpl          : 模板日志输出位置：./template.log
2023-10-06 14:39:37.031  INFO 20804 --- [main] m.e.service.impl.RunServiceImpl          : SQL之间换行数量：1
2023-10-06 14:39:37.031  INFO 20804 --- [main] m.e.service.impl.RunServiceImpl          : 是否写入到数据库：false
2023-10-06 14:39:37.031  INFO 20804 --- [main] m.e.service.impl.RunServiceImpl          : Excel配置：Excel[sheetAt=0, startRow=0, endRow=-1, startCell=0, endCell=-1]
2023-10-06 14:39:37.032  INFO 20804 --- [main] m.e.service.impl.RunServiceImpl          : 过滤器配置：{所属班级=[100001], 编码=[Noinfo, NotOnly, N000004-446-1151], 联系电话=[]}
2023-10-06 14:39:37.032 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 文件:./in6.xlsx
2023-10-06 14:39:37.032 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 加载高版本excel
2023-10-06 14:39:37.196 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始列：1
2023-10-06 14:39:37.197 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 结束列：8
2023-10-06 14:39:37.199 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 表头：[线路编号, 线路名称, 管理单位, 收运时间段, 车牌号, 司机, 联系电话]
2023-10-06 14:39:37.201 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 第2行数据：{收运时间段=5:30:00-18:00:00, 线路编号=33.0, 联系电话=1.3926148987E10, 司机=严洪强, 车牌号=粤AKE089, 管理单位=南沙车队, 线路名称=东涌089线}
2023-10-06 14:39:37.202 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 第3行数据：{收运时间段=5:30:00-18:00:00, 线路编号=34.0, 联系电话=1.3725460467E10, 司机=梁嘉威, 车牌号= 粤AHM202, 管理单位=南沙车队, 线路名称=东涌202线}
2023-10-06 14:39:37.202 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 第4行数据：{收运时间段=5:30:00-18:00:00, 线路编号=35.0, 联系电话=1.5622005499E10, 司机=沈上球, 车牌号=粤AFQ153, 管理单位=南沙车队, 线路名称=东涌153线}
2023-10-06 14:39:37.202 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 第5行数据：{收运时间段=5:30:00-18:00:00, 线路编号=36.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌一站线}
2023-10-06 14:39:37.202 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 第6行数据：{收运时间段=5:30:00-18:00:00, 线路编号=37.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌二站线}
2023-10-06 14:39:37.202 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 第7行数据：{收运时间段=5:30:00-18:00:00, 线路编号=38.0, 联系电话=13710300102烽13711028830荣15876522067有13434186232光15889933205周, 司机=梁永烽/郭志荣/郭桂有/李承周/梁铭光, 车牌号=粤AGQ282/粤AFG223/粤AHF907/粤AGA700/粤AGK683, 管理单位=南沙车队, 线路名称=东涌三站线}
2023-10-06 14:39:37.203 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 第8行数据：{收运时间段=5:30:00-18:00:00, 线路编号=39.0, 联系电话=1.3922361677E10, 司机=何泽文, 车牌号=粤AHK053, 管理单位=南沙车队, 线路名称=东涌餐厨053线}
2023-10-06 14:39:37.203 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 第9行数据：{收运时间段=5:30:00-18:00:00, 线路编号=40.0, 联系电话=1.3719428472E10, 司机=高炳棠, 车牌号=粤AGP738, 管理单位=南沙车队, 线路名称=东涌餐厨738线}
2023-10-06 14:39:37.203 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 第10行数据：{收运时间段=5:30:00-18:00:00, 线路编号=41.0, 联系电话=13711009292锋13533231181树13672441374安, 司机=莫尔树/俞龙安/钟伟锋, 车牌号=粤ACJ161/粤AGU005/粤AGU080, 管理单位=南沙车队, 线路名称=东涌大件物线}
2023-10-06 14:39:37.203  INFO 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : excel数据处理器执行顺序：-->字段排序excel数据处理器-->字段去重excel数据处理器-->数据打印excel数据处理器-->保存excel数据处理器
2023-10-06 14:39:37.203 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段排序excel数据处理器
2023-10-06 14:39:37.203 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段排序excel数据处理器
2023-10-06 14:39:37.203 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 字段去重excel数据处理器
2023-10-06 14:39:37.203 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 字段去重excel数据处理器
2023-10-06 14:39:37.203 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 数据打印excel数据处理器
2023-10-06 14:39:37.204 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 数据打印excel数据处理器
2023-10-06 14:39:37.204 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 开始进入 保存excel数据处理器
2023-10-06 14:39:37.256 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 保存的文件位于：out.xlsx
2023-10-06 14:39:37.256 DEBUG 20804 --- [main] m.e.service.impl.ExcelServiceImpl        : 退出 保存excel数据处理器
2023-10-06 14:39:37.256 DEBUG 20804 --- [main] m.e.service.impl.TemplateServiceImpl     : 生成的默认模板：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
2023-10-06 14:39:37.256  INFO 20804 --- [main] m.e.service.impl.RunServiceImpl          : 默认模板示例：insert into 表名 (线路编号,线路名称,管理单位,收运时间段,车牌号,司机,联系电话) values(${线路编号},${线路名称},${管理单位},${收运时间段},${车牌号},${司机},${联系电话});
